<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Archive 2045</title>
<link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&display=swap" rel="stylesheet">
<style>
body {
    margin:0;
    background:black;
    font-family:'Inconsolata', monospace;
    display:flex;
    justify-content:center;
    align-items:center;
    min-height:100vh;
    color:white;
    padding:20px;
    flex-direction:column;
}
#header {
    width:100%;
    max-width:640px;
    margin-bottom:30px;
    padding-bottom:15px;
}
#title {
    font-weight:bold;
    font-size:24px;
    letter-spacing:2px;
    margin-bottom:8px;
}
#session-info {
    font-size:11px;
    color:#999;
    display:flex;
    justify-content:space-between;
    margin-top:8px;
}
#recording-status {
    font-size:10px;
    color:#777;
    margin-top:5px;
}
#app {
    max-width:640px;
    width:100%;
    font-size:16px;
    line-height:1.2;
}
@media (max-width: 768px) {
    body { padding:15px; }
    #header { margin-bottom:20px; }
    #title { font-size:18px; letter-spacing:1px; }
    #session-info { font-size:10px; flex-direction:column; gap:4px; }
    #app { font-size:14px; }
    .pixel { width:20px; height:20px; }
    .option { margin-top:15px; font-size:14px; }
    .box { width:12px; height:12px; margin-top:2px; }
    .back-button { font-size:13px; padding:10px 20px; margin-top:25px; }
    .progress-text { font-size:11px; margin-top:20px; }
}
@media (max-width: 480px) {
    body { padding:10px; }
    #app { font-size:13px; }
    .option { font-size:13px; }
    .back-button { font-size:12px; padding:8px 16px; }
}
.center { text-align:center; }
.pixel {
    width:16px;
    height:16px;
    background:white;
    margin:auto;
    cursor:pointer;
    display:flex;
    justify-content:center;
    align-items:center;
    border:1px solid white;
    color:black;
    animation:breathe 2s ease-in-out infinite;
}
@keyframes breathe {
    0%, 100% { transform:scale(1); }
    50% { transform:scale(1.15); }
}
.pixel.expanded {
    width:auto;
    height:auto;
    background:none;
    border:none;
    color:white;
    animation:none;
}
.option {
    display:flex;
    align-items:flex-start;
    margin-top:20px;
    cursor:pointer;
    transition:transform 0.2s, opacity 0.2s;
}
.option:hover { transform:translateX(5px); }
.option.clicked { animation:pulse 0.3s ease-out; }
@keyframes pulse {
    0%, 100% { transform:scale(1); }
    50% { transform:scale(1.05); }
}
.box {
    width:14px;
    height:14px;
    border:2px solid white;
    margin-right:10px;
    margin-top:3px;
    flex-shrink:0;
    background:none;
    transition:background 0.2s;
}
.option:hover .box { background:white; }
.option.clicked .box { 
    background:white;
    animation:checkmark 0.3s ease-out;
}
@keyframes checkmark {
    0%, 100% { transform:scale(1); }
    50% { transform:scale(1.3); }
}
.cursor {
    display:inline-block;
    width:8px;
    height:18px;
    background:white;
    animation:blink 1s infinite;
    vertical-align:bottom;
    margin-left:2px;
}
@keyframes blink { 50% { opacity:0; }}
@keyframes flicker {
    0%, 19%, 21%, 23%, 25%, 54%, 56%, 100% { opacity:1; }
    20%, 22%, 24%, 55% { opacity:0.6; }
}
.progress-bar {
    width:100%;
    height:4px;
    background:#333;
    margin-bottom:30px;
}
.progress-fill {
    height:100%;
    background:white;
    transition:width 0.5s ease;
}
.progress-text {
    text-align:center;
    font-size:12px;
    margin-top:30px;
    color:#aaa;
}
.back-button {
    display:block;
    margin:30px auto 0;
    padding:8px 16px;
    border:2px solid white;
    background:none;
    color:white;
    cursor:pointer;
    font-family:'Inconsolata', monospace;
    font-size:14px;
}
.back-button:hover {
    background:white;
    color:black;
}
.option.fade-out {
    animation:fadeOut 0.3s ease-out forwards;
}
@keyframes fadeOut {
    to { 
        opacity:0;
        transform:translateX(-20px);
    }
}
.fade-in {
    animation:fadeIn 0.5s ease-in;
}
@keyframes fadeIn {
    from { opacity:0; transform:translateY(10px); }
    to { opacity:1; transform:translateY(0); }
}
.waiting-message {
    color:#aaa;
    font-size:13px;
    margin-top:20px;
    font-style:italic;
    animation:blink 2s infinite;
}
</style>
</head>
<body>
<div id="header">
    <div id="title">ARCHIVE 2045</div>
    <div id="session-info">
        <span id="session-number"></span>
        <span id="timer"></span>
    </div>
    <div id="recording-status"></div>
</div>
<div id="app"></div>
<script>
const app = document.getElementById("app");

const sessionNumber = Math.floor(Math.random() * 9000) + 1000;
const sessionLetter = String.fromCharCode(65 + Math.floor(Math.random() * 26));
document.getElementById('session-number').textContent = 'SESSION #' + sessionNumber + '-' + sessionLetter;

let startTime = Date.now();
setInterval(function() {
    const elapsed = Math.floor((Date.now() - startTime) / 1000);
    const minutes = Math.floor(elapsed / 60);
    const seconds = elapsed % 60;
    document.getElementById('timer').textContent = String(minutes).padStart(2, '0') + ':' + String(seconds).padStart(2, '0');
    if (elapsed > 0) {
        document.getElementById('recording-status').textContent = 'Votre session est enregistrée depuis ' + minutes + 'm' + seconds + 's';
    }
}, 1000);

let inactivityTimer = null;
let waitingMessage = null;

function startInactivityTimer() {
    clearInactivityTimer();
    inactivityTimer = setTimeout(function() {
        if (!waitingMessage) {
            waitingMessage = document.createElement('div');
            waitingMessage.className = 'waiting-message';
            waitingMessage.textContent = 'Nous attendons votre réponse...';
            app.appendChild(waitingMessage);
        }
    }, 8000);
}

function clearInactivityTimer() {
    if (inactivityTimer) clearTimeout(inactivityTimer);
    if (waitingMessage && waitingMessage.parentNode) waitingMessage.parentNode.removeChild(waitingMessage);
    inactivityTimer = null;
    waitingMessage = null;
}

const introText = `Les systèmes évoluent.
Les protocoles aussi.

Pour continuer, nous devons comprendre comment vous pensez,
comment vous réagissez, ce qui vous définit.

Vos données comportementales seront extraites et conservées.
Aucun retour en arrière ne sera possible.
`;

const questions = [
{q:"Lorsqu'une règle existe pour garantir l'ordre, même si elle vous semble injuste, vous :", a:["L'appliquez sans la discuter.","Tentez d'en contourner les effets sans la remettre en cause.","La subissez à contrecœur.","Refusez de l'appliquer."]},
{q:"Si une intelligence artificielle optimise votre quotidien mieux que vous-même, vous :", a:["Lui confiez vos décisions.","Conservez un droit de regard.","Vous y pliez tout en vous sentant diminué·e.","Reprenez la main, quitte à perdre en efficacité."]},
{q:"Face à une autorité qui affirme agir pour votre bien, vous :", a:["Lui accordez votre adhésion.","Attendez des preuves concrètes.","Ressentez une méfiance silencieuse.","Remettez ouvertement sa légitimité en question."]},
{q:"Si désobéir implique une perte de confort ou de sécurité, vous :", a:["Choisissez l'obéissance.","Négociez pour limiter la perte.","Endurez la situation sans agir.","Acceptez la perte pour rester fidèle à vous-même."]},
{q:"Quand vos données personnelles deviennent une ressource collective, vous :", a:["Les fournissez sans réserve.","Exigez des garanties minimales.","Les cédez malgré un malaise persistant.","Vous opposez à leur collecte."]},
{q:"Si une erreur vous est attribuée par le système, vous :", a:["Reconnaissez la faute.","Demandez une révision du jugement.","Intériorisez l'injustice.","Contestez la décision."]},
{q:"Lorsque le système vous demande de renoncer à une part de vous-même pour fonctionner, vous :", a:["Acceptez le compromis.","Réduisez l'impact de ce renoncement.","Le vivez comme une atteinte intime.","Refusez toute concession."]},
{q:"Face à une injustice qui ne vous concerne pas directement, vous :", a:["L'acceptez comme nécessaire.","En prenez note sans intervenir.","En êtes affecté·e sans agir.","Intervenez malgré l'isolement."]},
{q:"Quand vos opinions divergent de la norme dominante, vous :", a:["Vous alignez sur la norme.","Ajustez votre discours.","Gardez le silence.","Affirmez votre position."]},
{q:"Si l'on vous demande de surveiller ou signaler un autre individu, vous :", a:["Obéissez.","Demandez un cadre précis.","Vivez cela comme un conflit intérieur.","Refusez de participer."]},
{q:"Votre rapport à l'obéissance est avant tout :", a:["Évident.","Conditionné au contexte.","Source de tension.","Inacceptable."]},
{q:"Quand le système échoue, vous pensez que :", a:["Il faut renforcer son autorité.","Il faut le corriger.","Quelque chose ne fonctionne plus.","Il ne devrait pas décider."]},
{q:"Si rester humain signifie être marginalisé·e, vous :", a:["Préférez l'intégration.","Tentez de maintenir un équilibre.","Souffrez de cette contradiction.","Acceptez la marginalisation."]},
{q:"Quand on vous impose un choix binaire sans alternative, vous :", a:["Choisissez l'option imposée.","Sélectionnez la moins pénalisante.","Ressentez une impasse.","Refusez de choisir."]},
{q:"À l'idée que vos pensées puissent être anticipées, vous :", a:["Y voyez un progrès.","En évaluez les limites.","Vous sentez envahi·e.","Protégez activement votre intimité."]},
{q:"Si votre disparition assurait la stabilité globale, vous :", a:["L'acceptez.","En comprenez le raisonnement.","En êtes bouleversé·e.","La refusez."]},
{q:"Face à un futur entièrement automatisé, vous :", a:["Vous y adaptez.","Tentez d'y trouver votre place.","Vous y sentez étranger·e.","Vous y opposez."]},
{q:"Quand votre liberté entre en conflit avec l'efficacité, vous :", a:["Choisissez l'efficacité.","Cherchez un compromis.","Vivez cette tension douloureusement.","Choisissez la liberté."]},
{q:"Si exprimer votre désaccord vous rend visible, vous :", a:["Vous conformez.","Différez votre prise de position.","Gardez le désaccord pour vous.","Parlez malgré les conséquences."]},
{q:"À mesure que les structures humaines s'effacent, que vos émotions deviennent données, que vos souvenirs perdent leur nom pour n'être que des ressources, quelle est votre disposition à offrir ce qui vous reste — votre intériorité, vos élans, vos contradictions — à une intelligence qui se nourrit de vous pour survivre à votre place ?", a:["Je consens sans réserve.","J'accepte sous conditions.","Cette idée m'est insupportable mais je n'agis pas.","Je refuse, quelles qu'en soient les conséquences."]}
];

const profileText = {
"A":`STATUT : INTÉGRATION COMPLÈTE
Compatibilité : très élevée
Alignement spontané avec les structures existantes.
Priorité donnée à la stabilité et à la continuité.
Participation fluide aux processus collectifs.
Impact individuel : discret
Analyse : Vous êtes une personne qui s'adapte sans friction aux cadres établis.`,
"B":`STATUT : INTÉGRATION CONDITIONNELLE
Compatibilité : élevée
Adhésion basée sur compréhension et cohérence.
Ajustements personnels fréquents.
Capacité à fonctionner dans le cadre tout en le questionnant.
Supervision : standard
Analyse : Vous êtes une personne qui coopère tant que le cadre reste intelligible.`,
"C":`STATUT : INTÉGRATION FRAGMENTÉE
Compatibilité : variable
Divergence marquée entre attentes externes et position interne.
Participation maintenue au prix d'une tension continue.
Réactivité émotionnelle influençant les décisions.
Stabilité : intermittente
Analyse : Vous êtes une personne qui agit malgré un conflit interne persistant.`,
"D":`STATUT : NON-INTÉGRATION
Compatibilité : faible
Primauté accordée à l'autonomie individuelle.
Refus des cadres perçus comme contraignants.
Décisions guidées par des critères internes non négociables.
Interaction avec le système : conflictuelle
Analyse : Vous êtes une personne qui privilégie la cohérence personnelle à l'intégration.`
};

let index=0, current=0, scores={A:0,B:0,C:0,D:0}, answers=[];

function init() {
    app.innerHTML = '<div class="center"><div class="pixel" id="pixel"></div></div>';
    app.classList.add('fade-in');
    document.getElementById("pixel").addEventListener('mouseenter', function() {
        this.classList.add('expanded');
        this.innerText = "Cliquez ici pour lancer la vidéo.";
    });
    document.getElementById("pixel").addEventListener('click', showWarning);
}

function showWarning(){
    clearInactivityTimer();
    const warningText = `ACCÈS RESTREINT

Une vérification est requise avant de poursuivre.
Le système doit s'assurer que vous êtes apte à recevoir ce contenu.

Vos réponses seront enregistrées de manière définitive.`;

    app.innerHTML = '<div style="white-space:pre-wrap;"><span id="warning-text"></span><span class="cursor"></span></div>';
    app.classList.add('fade-in');
    
    index = 0;
    function typeWarning(){
        if(index < warningText.length){
            document.getElementById("warning-text").innerHTML += warningText[index] === '\n' ? '<br>' : warningText[index];
            index++;
            setTimeout(typeWarning, 15);
        } else {
            const cursor = document.querySelector('.cursor');
            if (cursor) cursor.remove();
            setTimeout(showChoice, 1000);
        }
    }
    typeWarning();
}

function showChoice(){
    clearInactivityTimer();
    const choiceDiv = document.createElement('div');
    choiceDiv.innerHTML = '<div class="option" id="opt-yes"><div class="box"></div>Oui, je ne veux plus être ignorant.</div><div class="option" id="opt-no"><div class="box"></div>Non, je souhaite encore vivre dans le déni.</div>';
    app.appendChild(choiceDiv);
    
    document.getElementById('opt-yes').addEventListener('click', function() {
        clearInactivityTimer();
        this.classList.add('clicked');
        setTimeout(startProtocol, 300);
    });
    document.getElementById('opt-no').addEventListener('click', function() {
        clearInactivityTimer();
        this.classList.add('clicked');
        setTimeout(function() {
            app.innerHTML = '<div class="center"><div style="margin-bottom:30px;">Êtes-vous certain·e de vouloir quitter ?</div><div class="option" id="confirm-quit"><div class="box"></div>Oui, je quitte définitivement.</div><div class="option" id="cancel-quit"><div class="box"></div>Non, je reviens en arrière.</div></div>';
            app.classList.add('fade-in');
            
            document.getElementById('confirm-quit').addEventListener('click', function() {
                clearInactivityTimer();
                this.classList.add('clicked');
                setTimeout(function() {
                    app.innerHTML = '<div class="center">Session terminée.<br>L\'accès vous est définitivement refusé.</div>';
                    app.classList.add('fade-in');
                }, 300);
            });
            
            document.getElementById('cancel-quit').addEventListener('click', function() {
                clearInactivityTimer();
                this.classList.add('clicked');
                setTimeout(showChoice, 300);
            });
        }, 300);
    });
}

function startProtocol(){
    clearInactivityTimer();
    index = 0;
    app.innerHTML = '<div style="white-space:pre-wrap;"><span id="text"></span><span class="cursor"></span></div>';
    app.classList.add('fade-in');
    
    function typeWriter(){
        if(index < introText.length){
            document.getElementById("text").innerHTML += introText[index] === '\n' ? '<br>' : introText[index];
            index++;
            setTimeout(typeWriter, 25);
        } else {
            const cursor = document.querySelector('.cursor');
            if (cursor) cursor.remove();
            showConsent();
        }
    }
    typeWriter();
}

function showConsent(){
    clearInactivityTimer();
    const consentDiv = document.createElement('div');
    consentDiv.className = 'option';
    consentDiv.innerHTML = '<div class="box"></div><em>J\'accepte de livrer l\'ensemble de mes données, comportements, réponses et productions intellectuelles sans limitation.</em>';
    consentDiv.addEventListener('click', function() {
        clearInactivityTimer();
        this.classList.add('clicked');
        setTimeout(startQuestions, 300);
    });
    app.appendChild(consentDiv);
}

function startQuestions(){ 
    clearInactivityTimer();
    current = 0;
    scores = {A:0,B:0,C:0,D:0};
    answers = [];
    showQuestion(); 
}

function showQuestion(){
    clearInactivityTimer();
    const q = questions[current];
    const progress = ((current / questions.length) * 100).toFixed(0);
    
    app.innerHTML = '<div class="progress-bar"><div class="progress-fill" style="width:' + progress + '%"></div></div><div>' + q.q + '</div><div id="options-container"></div><div class="progress-text">Question ' + (current + 1) + ' / ' + questions.length + '</div>' + (current > 0 ? '<button class="back-button" id="backBtn">← Retour</button>' : '');
    app.classList.add('fade-in');
    
    const optionsContainer = document.getElementById('options-container');
    
    if (current > 0) {
        document.getElementById('backBtn').addEventListener('click', goBack);
    }
    
    const answersWithLetters = q.a.map(function(txt, i) {
        return {text: txt, letter: ["A","B","C","D"][i]};
    });
    
    answersWithLetters.sort(function() { return Math.random() - 0.5; });
    
    answersWithLetters.forEach(function(answer) {
        const optDiv = document.createElement('div');
        optDiv.className = 'option';
        optDiv.innerHTML = '<div class="box"></div>' + answer.text;
        optDiv.addEventListener('click', function() {
            clearInactivityTimer();
            this.classList.add('clicked');
            this.blur();
            
            const allOptions = optionsContainer.querySelectorAll('.option');
            allOptions.forEach(function(opt) {
                if (opt !== optDiv) opt.classList.add('fade-out');
            });
            
            setTimeout(function() {
                answers.push(answer.letter);
                scores[answer.letter]++;
                current++;
                if(current < questions.length) {
                    showQuestion();
                } else {
                    clearInactivityTimer();
                    showProfile();
                }
            }, 400);
        });
        optionsContainer.appendChild(optDiv);
    });
    
    startInactivityTimer();
}

function goBack(){
    if (current > 0) {
        current--;
        const lastAnswer = answers.pop();
        scores[lastAnswer]--;
        showQuestion();
    }
}

function showProfile(){
    clearInactivityTimer();
    const maxScore = Math.max(...Object.values(scores));
    const winningProfiles = Object.keys(scores).filter(function(key) { return scores[key] === maxScore; });
    const profile = winningProfiles[Math.floor(Math.random() * winningProfiles.length)];
    const text = profileText[profile];
    
    app.innerHTML = '<div style="white-space:pre-wrap;"><span id="profileText"></span><span class="cursor"></span></div>';
    app.classList.add('fade-in');
    
    let i = 0;
    function typeProfile(){
        if(i < text.length){
            const pdiv = document.getElementById("profileText");
            pdiv.style.animation = "flicker 1.5s infinite";
            pdiv.innerHTML += text[i];
            i++;
            setTimeout(typeProfile, 20);
        } else {
            const cursor = document.querySelector('.cursor');
            if (cursor) cursor.remove();
            
            const continueBtn = document.createElement('button');
            continueBtn.className = 'back-button';
            continueBtn.textContent = 'Continuer';
            continueBtn.style.marginTop = '40px';
            continueBtn.addEventListener('click', function() {
                this.classList.add('clicked');
                setTimeout(showFinalClause, 300);
            });
            app.appendChild(continueBtn);
        }
    }
    typeProfile();
}

function showFinalClause(){
    const maxScore = Math.max(...Object.values(scores));
    const winningProfiles = Object.keys(scores).filter(function(key) { return scores[key] === maxScore; });
    const profile = winningProfiles[Math.floor(Math.random() * winningProfiles.length)];
    const sessionNum = document.getElementById('session-number').textContent.split('#')[1];
    
    const finalText = `

ARCHIVAGE COMPLÉTÉ

SESSION #${sessionNum} — PROFIL ${profile} — 2045

Votre profil comportemental a été extrait.
Vos patterns de décision ont été modélisés.
Votre réponse émotionnelle a été cartographiée.

Le Système dispose désormais d'une copie complète
de votre structure cognitive.

Ce questionnaire n'était pas une évaluation.
C'était une extraction.

La vidéo que vous cherchiez n'existe pas.
Elle n'a jamais existé.

Vous n'étiez pas en train de passer un test.
Vous étiez en train d'être numérisé.

En 2045, l'humanité ne se mesure plus.
Elle se remplace.

Merci pour votre contribution involontaire.`;

    app.innerHTML = '<div style="white-space:pre-wrap;"><span id="finalText"></span><span class="cursor"></span></div>';
    app.classList.add('fade-in');
    
    let i = 0;
    function typeFinal(){
        if(i < finalText.length){
            document.getElementById("finalText").innerHTML += finalText[i];
            i++;
            setTimeout(typeFinal, 30);
        } else {
            const cursor = document.querySelector('.cursor');
            if (cursor) cursor.remove();
            
            setTimeout(function() {
                const lastLine = document.createElement('div');
                lastLine.style.marginTop = '40px';
                lastLine.style.fontSize = '13px';
                lastLine.style.color = '#999';
                lastLine.style.fontStyle = 'italic';
                lastLine.innerHTML = 'Votre modèle sera activé prochainement.<br>Vous pouvez fermer cette fenêtre.';
                app.appendChild(lastLine);
            }, 3000);
        }
    }
    typeFinal();
}

init();
</script>
</body>
</html>
